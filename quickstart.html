<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Introducing the Azure Storage Type Provider
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Stuff" />
    <meta name="author" content="Isaac Abraham" />

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet" />

    <link type="text/css" rel="stylesheet" href="./content/style.css" />
    <link type="text/css" rel="stylesheet" href="deedle.css" />
    <script type="text/javascript" src="./content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body>
    <div class="container">
        <div class="masthead">
            <ul class="nav nav-pills pull-right">
                <li><a href="http://fsharp.org">fsharp.org</a></li>
                <li><a href="http://github.com/fsprojects/AzureStorageTypeProvider">github page</a></li>
            </ul>
            <h3 class="muted"><a href="./index.html">Azure Storage Type Provider</a></h3>
        </div>
        <hr />
        <div class="row">
            <div class="span9" id="main">
                
<h1><a name="Introducing-the-Azure-Storage-Type-Provider" class="anchor" href="#Introducing-the-Azure-Storage-Type-Provider">Introducing the Azure Storage Type Provider</a></h1>
<p>The Azure Storage Type Provider is designed to let you rapidly access your
storage assets in Azure from F# without the need to resort to third party tools
or the server explorer in Visual Studio.</p>
<p>The provider is designed to be as easy as possible to consume, whilst allowing
several benefits over using the standard .NET SDK, such as removing the need for
magic strings when access tables / queues / blobs, as well as strengthening the
typing of queries over tables.</p>
<h1><a name="Connecting-to-Azure" class="anchor" href="#Connecting-to-Azure">Connecting to Azure</a></h1>
<p>Connecting to your storage account is simple.</p>
<p>From within a script, first <code>#load "AzureStorageProvider.fsx"</code> to reference all dependencies.
Then, you can generate a type for a storage account simply by providing your Azure
account credentials via a number of ways.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span class="i">FSharp</span><span class="o">.</span><span class="i">Azure</span><span class="o">.</span><span class="i">StorageTypeProvider</span>

<span class="c">// Connect to a live account using a standard Azure Storage connection string</span>
<span class="k">type</span> <span class="i">Live</span> <span class="o">=</span>
    <span class="i">AzureTypeProvider</span><span class="o">&lt;</span><span class="s">&quot;DefaultEndpointsProtocol=https;AccountName=name;AccountKey=key;&quot;</span><span class="o">&gt;</span>

<span class="c">// Connect to a live account using a two-part name and key.</span>
<span class="k">type</span> <span class="i">LiveTwoPart</span> <span class="o">=</span> <span class="i">AzureTypeProvider</span><span class="o">&lt;</span><span class="s">&quot;name&quot;</span>, <span class="s">&quot;key&quot;</span><span class="o">&gt;</span>

<span class="c">// Connect to local storage emulator</span>
<span class="k">type</span> <span class="i">Local</span> <span class="o">=</span> <span class="i">AzureTypeProvider</span><span class="o">&lt;</span><span class="s">&quot;UseDevelopmentStorage=true&quot;</span><span class="o">&gt;</span>

<span class="c">// Connect via configuration file with named connection string.</span>
<span class="k">type</span> <span class="i">FromConfig</span> <span class="o">=</span> <span class="i">AzureTypeProvider</span><span class="o">&lt;</span><span class="i">connectionStringName</span> <span class="o">=</span> <span class="s">&quot;myConnection&quot;</span>, <span class="i">configFileName</span><span class="o">=</span><span class="s">&quot;sample.config&quot;</span><span class="o">&gt;</span>
</code></pre></td>
</tr>
</table>
<p>An example <code>sample.config</code> file can be found  at <code>AzureStorageTypeProvider/docs/content/sample.config</code>.</p>
<h1><a name="Common-Themes" class="anchor" href="#Common-Themes">Common Themes</a></h1>
<p>The API is split into three areas: <strong>Tables</strong>, <strong>Queues</strong> and <strong>Containers</strong>.</p>
<p>All three share some common themes: -</p>
<ul>
<li>
Where possible, entities such as queues, tables, containers, folders or blobs are typed based on
live queries to the appropriate underlying storage SDK. Thus there's no requirement to enter magic
strings for blobs, tables or queues.
</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Reference the &quot;employee&quot; table. No magic strings needed.</span>
<span class="k">let</span> <span class="i">employee</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Tables</span><span class="o">.</span><span class="i">employee</span><span class="o">.</span><span class="i">Get</span>(<span class="i">Row</span> <span class="s">&quot;1&quot;</span>, <span class="i">Partition</span> <span class="s">&quot;somepartition&quot;</span>)

<span class="c">// Navigation through the &quot;samples&quot; container to the &quot;folder/childFile.txt&quot; blob.</span>
<span class="k">let</span> <span class="i">blobContents</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Containers</span><span class="o">.</span><span class="i">samples</span><span class="o">.</span><span class="i">``folder/``</span><span class="o">.</span><span class="i">``childFile.txt``</span><span class="o">.</span><span class="i">Read</span>()

<span class="c">// Reference the &quot;sample-queue&quot; queue.</span>
<span class="k">let</span> <span class="i">queueMessage</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Queues</span><span class="o">.</span><span class="i">``sample-queue``</span><span class="o">.</span><span class="i">Dequeue</span>()
</code></pre></td>
</tr>
</table>
<ul>
<li>
Common methods and functionality are made available directly on the appropriate assets, but
there's always access to the raw Azure SDK if you need it to do anything more.
</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
<span class="l">8: </span>
<span class="l">9: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Get the raw Azure Cloud Blob Client and use it to get a ref to the same blob.</span>
<span class="k">let</span> <span class="i">rawBlobRef</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Containers</span><span class="o">.</span><span class="i">CloudBlobClient</span><span class="o">.</span><span class="i">GetContainerReference</span>(<span class="s">&quot;samples&quot;</span>)
                                                 <span class="o">.</span><span class="i">GetBlockBlobReference</span>(<span class="s">&quot;folder/childFile.txt&quot;</span>)

<span class="c">// Or for the Cloud Table Client</span>
<span class="k">let</span> <span class="i">rawTableRef</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Tables</span><span class="o">.</span><span class="i">CloudTableClient</span><span class="o">.</span><span class="i">GetTableReference</span>(<span class="s">&quot;employee&quot;</span>)

<span class="c">// Or use a hybrid approach - use the TP to find the asset you want and then switch.</span>
<span class="k">let</span> <span class="i">rawBlobRefHybrid</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Containers</span><span class="o">.</span><span class="i">samples</span><span class="o">.</span><span class="i">``folder/``</span><span class="o">.</span><span class="i">``childFile.txt``</span><span class="o">.</span><span class="i">AsCloudBlockBlob</span>()
</code></pre></td>
</tr>
</table>
<ul>
<li>
You can override the connection to the destination asset at runtime. This is useful if not using
configuration files so that you can use your local (free) storage emulator for development, and then
move to a live account when testing or moving to production etc.. In addition it's also useful for
data migration scenarios.
</li>
</ul>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// Redirect to a blob using a different connection string.</span>
<span class="k">let</span> <span class="i">liveBlob</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Containers</span><span class="o">.</span><span class="i">samples</span><span class="o">.</span><span class="i">``file1.txt``</span><span class="o">.</span><span class="i">AsCloudBlockBlob</span>(<span class="s">&quot;myOtherConnectionString&quot;</span>)

<span class="c">// Get row 1A from the &quot;employee&quot; table using a different connection string.</span>
<span class="k">let</span> <span class="i">row1A</span> <span class="o">=</span> <span class="i">Local</span><span class="o">.</span><span class="i">Tables</span><span class="o">.</span><span class="i">employee</span><span class="o">.</span><span class="i">Get</span>(<span class="i">Row</span> <span class="s">&quot;1&quot;</span>, <span class="i">Partition</span> <span class="s">&quot;A&quot;</span>, <span class="s">&quot;myOtherConnectionString&quot;</span>)
</code></pre></td>
</tr>
</table>


            </div>
            <div class="span3">
                <img src="./img/logo.png" alt="F# Project" style="width:150px;margin:10px" />
                <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
                    <li class="nav-header">Azure Storage Type Provider</li>
                    <li><a href="./index.html">Home page</a></li>
                    <li class="divider"></li>
                    <li><a href="http://www.nuget.org/packages/FSharp.Azure.StorageTypeProvider">Get Library via NuGet</a></li>
                    <li><a href="http://github.com/fsprojects/AzureStorageTypeProvider">Source Code on GitHub</a></li>
                    <li><a href="http://github.com/fsprojects/AzureStorageTypeProvider/blob/master/LICENSE.txt">License</a></li>
                    <li><a href="http://github.com/fsprojects/AzureStorageTypeProvider/blob/master/RELEASE_NOTES.md">Release Notes</a></li>

                    <li class="nav-header">Getting started</li>
                    <li><a href="./quickstart.html">Quick start</a></li>
                    <li><a href="./blobs.html">Using Azure Blobs</a></li>
                    <li><a href="./tables.html">Using Azure Tables</a></li>
                    <li><a href="./queues.html">Using Azure Storage Queues</a></li>
                    <li><a href="./hot-schema-loading.html">Hot Schema Loading</a></li>

                    <li class="nav-header">Documentation</li>
                    <li><a href="./reference/index.html">API Reference</a></li>
                </ul>
            </div>
        </div>
    </div>
    <a href="http://github.com/fsprojects/AzureStorageTypeProvider"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub" /></a>
</body>
</html>
